2005-10-14  Akira TAGOH  <at@gclab.org>

	* donrails/lib/modules/wiliki.rb (DonRails::Wiliki::title_to_html):
	don't include a space into the front strings matched.

2005-10-10  ARAKI Yasuhiro  <yasu@debian.or.jp>

	* donrails/app/views/atom/index.rxml: Change for adding recent articles in /atom/.

	* donrails/app/views/atom/feed.rxml: Change for adding recent articles in /atom/feed.

	* donrails/app/controllers/atom_controller.rb: Change for no auth at /atom/feed. Change for adding recent articles in /atom/ and /atom/feed.

	* donrails/app/controllers/application.rb: Fix for WSSE auth.

2005-10-07  Akira TAGOH  <at@gclab.org>

	* donrails/app/views/shared/title-articles.rhtml: use don_mb_truncate
	instead of truncate.
	* donrails/app/views/login/manage_comment.rhtml: likewise.
	* donrails/app/views/login/manage_article.rhtml: likewise.
	* donrails/app/views/notes/show_category.rhtml: likewise.

	* donrails/app/helpers/application_helper.rb (ApplicationHelper::don_mb_truncate):
	similar method to truncate, but multibytes support.

2005-10-04  Akira TAGOH  <at@gclab.org>

	* donrails/lib/modules/wiliki.rb (DonRails::Wiliki::body_to_html):
	fixed the behavior to work similar to wiliki.

2005-10-01  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/lib/antispam.rb: Modify to apply 'ipaddr' and 'hostname' in Blacklist.format.

	* donrails/app/views/login/manage_blacklist.rhtml: New file.

	* donrails/app/views/layouts/login.rhtml: Add link to manage_blacklist.

	* donrails/app/views/shared/comment.rhtml: Remove unused comment line.

2005-10-01  Akira TAGOH  <at@gclab.org>

	* donrails/lib/donplugin.rb (DonRails::Plugin): New class.

	* donrails/tool/plugin-setup.rb (Installer::uninstall):
	removed the unnecessary debug code.
	(TableInstaller::initialize): prefer the absolute path.

	* donrails/plugins/calendar/calendar.rhtml: removed style tag to be
	XHTML compliant.

	* donrails/app/helpers/application_helper.rb (ApplicationHelper::don_get_stylesheets):
	New method to get the list of stylesheets required.

2005-09-30  Akira TAGOH  <at@gclab.org>

	* donrails/app/views/shared/comment.rhtml: Use maxlength instead of
	maxsize.

	* donrails/lib/modules/wiliki.rb (DonRails::Wiliki::body_to_html):
	Modified to be XHTML compliant.
	(DonRails::Wiliki::output_list): likewise.

2005-09-28  Akira TAGOH  <at@gclab.org>

	* donrails/lib/modules/hnf.rb (DonRails::HNF::body_to_html):
	Modified to be XHTML compliant.

	* donrails/lib/modules/wiliki.rb (DonRails::Wiliki::body_to_html):
	Use <br/> instead of <br> to be XHTML compliant.

2005-09-27  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/app/views/login/manage_comment.rhtml: Change id='ca' to 'comment_ajax'.

	* donrails/app/views/shared/comment.rhtml: Change 'id' for unique. 

2005-09-26  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/app/controllers/login_controller.rb: Fix orphaned comments problem. 

	* donrails/donrails/app/controllers/atom_controller.rb: Fix AtomAPI delete success return code 200 to 204. (According to draft-ietf-atompub-protocol-04.txt.)

2005-09-25  Akira TAGOH  <at@gclab.org>

	* donrails/tool/plugin-setup.rb: Added new program to assist the plugin
	installation/removal.

	* donrails/tool/tables-sqlite.txt: Added plugins table.
	* donrails/tool/tables-postgresql.txt: likewise.

	* donrails/plugins/calendar: New plugin for calendar.
	* donrails/lib/calendar.rb: likewise.
	* donrails/public/stylesheets/calendar.css: likewise.

	* donrails/app/views/shared/calendar.rhtml: moved onto plugins directory.
	* donrails/app/views/shared/comment.rhtml: removed the unnecessary </p> tag.

	* donrails/app/models/plugin.rb: New model class.

2005-09-09  Akira TAGOH  <at@gclab.org>

	* donrails/public/stylesheets/calendar.css: New file.

	* donrails/app/views/shared/calendar.rhtml: New file.

	* donrails/lib/calendar.rb: New file to generate the calendar.

2005-09-09  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/app/models/author.rb: Validates presence.

	* donrails/app/models/blacklist.rb: Validates presence.

2005-09-08  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/tool/tables-postgresql.txt: Add new 'blacklists' table.

	* donrails/tool/tables-sqlite.txt: Add new 'blacklists' table.

	* donrails/lib/antispam.rb: Change for using 'blacklists' table.

	* donrails/app/controllers/login_controller.rb: New method: {manage|delete|add}_blacklist.

	* donrails/app/models/blacklist.rb: New file.

	* donrails/app/models/blacklist_pattern.rb: Delete file.

2005-09-08  Akira TAGOH  <at@gclab.org>

	* donrails/app/views/login/authenticate.rhtml: choose the preferred
	format by default.

	* donrails/app/controllers/login_controller.rb (LoginController::authenticate):
	determine which format is mostly used.

	* donrails/lib/modules/wiliki.rb (DonRails::Wiliki::title_to_html):
	New method.

	* donrails/lib/modules/hnf.rb (DonRails::HNF::body_to_html): split
	the strings up against CRLF or CR or LF.

	* donrails/lib/modules/wiliki.rb: New input format parser module to
	support WiLiKi format.
	(DonRails::Wiliki::body_to_html): split the strings up against CRLF or CR or LF.
	(DonRails::Wiliki::output_block): escape the strings when it's in pre tag.

2005-09-07  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/lib/modules/hnf.rb: Fix for luck of LF in PRE /PRE commands.

	* donrails/lib/antispam.rb: Fix for call subroutine.
	
2005-09-06  Akira TAGOH  <at@gclab.org>

	* donrails/lib/modules/rd.rb: trivial fix.

2005-09-05  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/lib/modules/hnf.rb: Fix for does not process line which is started with "~".

2005-09-04  ARAKI Yasuhiro  <yasu@debian.or.jp>

	* donrails/app/views/atom/index.rxml: Add link to service.feed and service.categories.

	* donrails/app/views/atom/categories.rxml: New file.

	* donrails/app/views/atom/feed.rxml: New file.

	* donrails/app/controllers/atom_controller.rb:
	- Change wsse_auth debug ip address. Localhost client pass without wsse.
	- New method feed().
	- New method categories().

2005-09-04  Akira TAGOH  <at@gclab.org>

	* donrails/app/controllers/notes_controller.rb (NotesController::noteslist):
	Added an exception.

2005-09-03  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/app/views/login/manage_author.rhtml: Change description in english to japanese.

	* donrails/app/views/layouts/login.rhtml: Add link for ':action => "logout"'.

2005-09-02  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/app/models/author.rb: Fix filename.(wrong file name: authors.rb)

	* donrails/app/views/notes/show_title.rhtml: (Partially) Fix for don_get_object.

	* INSTALL.ja: Donrails now depends on RD library.

        * donrails/tools/table-{sqlite,postgresql}.txt: Add Author.writable

        * donrails/app/controller/login_controller.rb: Change for manage_author.rhtml

        * donrails/app/views/login/manage_author.rhtml: New view for management
AtomAPI authors.

2005-09-01  Akira TAGOH  <at@gclab.org>

	* donrails/lib/delegator.rb (DonRails::DataFormatDelegator): undef id
	to pass it to the original object.
	(DonRails::DataFormatDelegator::formatmap): store the modules list
	into $formatmap and ensure to do Dir.glob just one time.

2005-08-31  Akira TAGOH  <at@gclab.org>

	* donrails/app/helpers/application_helper.rb (ApplicationHelper::don_get_object):
	New method to get DataFormatDelegator object for the article.
	(ApplicationHelper::don_to_title): removed.
	(ApplicationHelper::don_to_html): removed.

	* donrails/lib/modules/rd.rb (DonRails::RD::title_to_html): renamed from title.
	(DonRails::RD::body_to_html): renamed from to_html.
	(DonRails::RD::title_to_xml): New method.
	(DonRails::RD::body_to_xml): New method.

	* donrails/lib/modules/hnf.rb (DonRails::HNF::title_to_html): renamed from title.
	(DonRails::HNF::body_to_html): renamed from to_html.
	(DonRails::HNF::title_to_xml): New method.
	(DonRails::HNF::body_to_xml): New method.

	* donrails/lib/delegator.rb (DonRails::DataFormatDelegator::initialize): API changes.
	(DonRails::DataFormatDelegator::method_missing): extend String and call
	the method here when the method name '<fieldname>_to_<type>' is given.
	(DonRails::PlainText::title_to_html): renamed from title
	(DonRails::PlainText::body_to_html): renamed from to_html
	(DonRails::PlainText::chomp_tags): moved to ApplicationHelper#don_chomp_tags
	(DonRails::PlainText::title_to_xml): New method.
	(DonRails::PlainText::body_to_xml): New method.

	* donrails/app/views/shared/linktitle.rhtml: applied the above changes.
	* donrails/app/views/shared/title-articles2no.rhtml: likewise.
	* donrails/app/views/shared/title-articles2.rhtml: likewise.
	* donrails/app/views/shared/title-articles.rhtml: likewise.
	* donrails/app/views/shared/random-article.rhtml: likewise.
	* donrails/app/views/notes/show_category.rhtml: likewise.
	* donrails/app/views/notes/show_category2.rhtml: likewise.
	* donrails/app/views/notes/show_title.rhtml: likewise.
	* donrails/app/views/notes/noteslist.rhtml: likewise.
	* donrails/app/views/notes/search.rhtml: likewise.
	* donrails/app/views/notes/pick_article.rhtml: likewise.
	* donrails/app/views/notes/pick_article_a.rhtml: likewise.
	* donrails/app/views/notes/rdf_recent.rxml: likewise.

2005-08-28  ARAKI Yasuhiro  <yasu@debian.or.jp>

	* donrails/lib/modules/hnf.rb: Fix for not processing HNF command line which begin with "/".

	* donrails/app/views/login/authenticate.rhtml: Little change <hr><hr> to <hr>.

	* donrails/app/views/layouts/login.rhtml: Add link to manage_author(), delete_author()

	* donrails/app/controllers/login_controller.rb: New manage_author(), delete_author() for atom author management.

2005-08-27  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/lib/modules/hnf.rb: Fix for not displaying body.

	* donrails/app/views/login/authenticate.rhtml: Remove links to manage_article/manage_comment/hnf_save_all. Because these links now in layouts/login.rhtml

	* donrails/app/views/layouts/login.rhtml: Change for easy navigation.

	* donrails/app/controllers/login_controller.rb: NEW logout().

	* donrails/app/controllers/application.rb: WSSE authentification function change. Now use user/pass pair is sotred in Authors.

2005-08-26  Akira TAGOH  <at@gclab.org>

	* donrails/lib/modules/hnf.rb (DonRails::HNF::to_html): fixed a typo.

	* donrails/app/views/shared/linktitle.rhtml: modified to fit to the latest application helper.
	* donrails/app/views/shared/title-articles2no.rhtml: likewise.
	* donrails/app/views/shared/title-articles2.rhtml: likewise.
	* donrails/app/views/shared/title-articles.rhtml: likewise.
	* donrails/app/views/shared/rundom-article.rhtml: likewise.

	* donrails/app/views/notes/show_category.rhtml: modified to fit to the latest application helper.
	* donrails/app/views/notes/show_category2.rhtml: likewise.
	* donrails/app/views/notes/show_title.rhtml: likewise.
	* donrails/app/views/notes/search.rhtml: likewise.
	* donrails/app/views/notes/pick_article.rhtml: likewise.

	* donrails/app/helpers/application_helper.rb (ApplicationHelper::don_chomp_tags):
	  New method.

	* donrails/app/helpers/hnf_helper.rb: REMOVED.

	* donrails/lib/delegator.rb (DonRails::PlainText::title): New method.
	(DonRails::DataFormatDelegator::formatmap): hack to find the input format modules all.

	* donrails/lib/modules/hnf.rb (DonRails::HNF::title): New method.

	* donrails/lib/modules/rd.rb (DonRails::RD::title): New method.
	(DonRails::RD::to_html): ensure "\n" at the end of the given string.

	* donrails/app/views/notes/noteslist.rhtml: modified against the application_helper.rb's change.

	* donrails/app/views/notes/pick_article_a.rhtml: likewise.

	* donrails/app/views/login/authenticate.rhtml: show the supported input format from
	  don_supported_formats instead of hardcoded stuff.

	* donrails/app/helpers/application_helper.rb (ApplicationHelper::don_supported_formats):
	  New method to get which input format DonRails supported.
	(ApplicationHelper::don_to_title): New method to convert String to the article title.
	(ApplicationHelper::don_to_html): New method to convert String to HTML.
	(ApplicationHelper::remove_html_gl, don_lnew, don_link, plain_remove_html_gl):
	(ApplicationHelper::plain_don_link, plain_don_line_link, plain_don_line_2kaigyo):
	(ApplicationHelper::plain_don_lnew): REMOVED.

2005-08-26  araki yasuhiro  <yasu@debian.or.jp>

	* donrails/app/models/authors.rb: New models. It store user/pass entry for AtomAPI post/edit/delete.

	* donrails/app/controllers/application.rb: Change wsse_match(user,pass,wsse) to wsse_match(wsse). wsse_match(wsse) search user and pass from Authors.
	* donrails/tool/tables-sqlite.txt: Add authors table.
	* donrails/tool/tables-postgresql.txt: Add authors table.
	* donrails/tool/tables.txt: REMOVE.

	* donrails/app/helpers/application_helper.rb: Fix pub_date time format. Now use Time.iso8601.

	* donrails/app/controllers/application.rb: Fix regexp error.

	* donrails/app/helpers/application_helper.rb: Add don_lnew() and plain_don_lnew(). These are removed from hnf_helper.rb.

	* INSTALL.ja: Add information for setup.

	* donrails/app/views/atom/{index|post}.rxml: New AtomAPI template.

	* donrails/app/controllers/atom_controller.rb: New controler. AtomAPI controller.

2005-08-26  Akira TAGOH  <at@gclab.org>

	* donrails/lib/modules/rd.rb: New module. RD parser.

	* donrails/lib/modules/hnf.rb: New module. hnf parser.

	* donrails/lib/delegator.rb: New class to delegate the object to each output format module.

2005-08-25  Akira TAGOH  <at@gclab.org>

	* donrails/app/views/login/authenticate.rhtml: fixed a typo. plainf should be plain.

	* donrails/app/helpers/application_helper.rb (ApplicationHelper::plain_don_line_2kaigyo): fixed a typo.

	* donrails/tool/tables-postgresql.txt: New file for PostgreSQL.

	* donrails/app/controllers/login_controller.rb (LoginController::delete_article): prevent NoMethodError for nil.

2005-08-25  araki yasuhiro  <yasu@debian.or.jp>

	* Add: """map.connect '', :controller => "notes", :action => "index" """ in routes.rb. 

2005-08-25  Akira TAGOH  <at@gclab.org>

	* donrails/app/controllers/notes_controller.rb (NotesController::recent_category): returns the empty Array when there is no categories.

2005-08-24  araki yasuhiro  <yasu@debian.or.jp>

	* New: apply for "plain" article format.

	* Change: at no articles, return 404.

	* Split application_helper.rb's HNF related lines to "hnf_helper.rb".

	* Add: Makefile: "make init" make link to donrails/lib to use antispam.rb.

	* Fix: INSTALL.ja: config files are located under rails/config. (wrong: donrails/config) (thanks tagoh)

2005-08-23  araki yasuhiro  <yasu@debian.or.jp>

	* Change: donrails-setup.rb: Now some values set dafault.(thanks tagoh)

2005-08-22  araki yasuhiro  <yasu@debian.or.jp>

	* Add: In map.connect "notes/every_year/:month/:day" to display the same day of the year.

2005-08-21  ARAKI Yasuhiro  <yasu@debian.or.jp>

	* New: wsse_generate and wsse_match. These will be used for AtomAPI.

2005-08-20  ARAKI Yasuhiro  <yasu@debian.or.jp>

	* Change: Paginate for notes/afterday is broken. Now notes/afterday is not paginated. Simply show 30 articles.

	* New: "@noindex" class parameter to control add '''<meta name="robots" content="noindex">''' tag in header. (Please show notes.rhtml)

	* Change: notes_controller.rb: 'dateparse' method is now protected.

2005-08-19  araki yasuhiro  <yasu@debian.or.jp>

	* Change: Makefile and donrails-setup.rb: "rails -d rails" is maybe debian extension. I change "rails rails" to setup by 'make' command. (thanks: tagoh)
	* Fix: At artilce format is HNF, "<img src=... >" is not rendered.

	* Add: can show cross year same day articles. For example, "notes/?0101" show Jun.1 day's articles. Now it limits 10 years.

2005-08-18  araki yasuhiro  <yasu@debian.or.jp>

	* Fix: add_comment2: Can not post comment under /note/titile/hogehoge...
	* Change rdf_recent.rxml title format. If title includes URL scheme, not it is stripped.
	
2005-08-17  araki yasuhiro  <yasu@debian.or.jp>

	* Fix: some user defined tags (TENKI, TAION..) are displayed. 

2005-08-16  araki yasuhiro  <yasu@debian.or.jp>

	* Add: show_title search trigger by 'id'. If 'id' is lacked, use 'title'.
	* Change rdf_recent.rxml date format from Article.ariticle_date to Article.article_mdate.
	
2005-08-15  araki yasuhiro  <yasu@debian.or.jp>

	* Fix: hnf2db.rb could not use rail/lib/antispam.rb. Fixed.
	* If "yyyymm(a|b|c)", show the (first|2nd|3rd) ten days of a month.

2005-08-14  araki yasuhiro  <yasu@debian.or.jp>

	* add function for comment spam. Many functions derived from "typo".

2005-08-12  araki yasuhiro  <yasu@debian.or.jp>

	* Add @recent_comment parameters to display recent articles with comments.

2005-08-10  araki yasuhiro  <yasu@debian.or.jp>

	* At displaying search results, seach keyword is highlighted.
	* At displaying search results, seach text is excerpted.

	* Comment validation methods are changed. Now it works in model/comment.rb
	* In Comment.body, If you want to write HTML format, you can use restricted tags. (Current: allow = ['p','br','i','b','u','ul','li'])

2005-08-08  araki yasuhiro  <yasu@debian.or.jp>

	* Fix: Backup all articles in "hnf" file format is not working.

2005-08-07  araki yasuhiro  <yasu@debian.or.jp>

	* Fix: the function (show_date in notes_controler.rb) does not run well.
	* Add: "view/layout/login.rhtml". All under "login" use login.rhtml as layout.
	* Add: "login/form_article". For fixing article title and body.
	
2005-08-06  araki yasuhiro  <yasu@debian.or.jp>

	* convert all euc-jp files to utf-8.
	* prepare import to "svn://svn.berlios.de/donrails/trunk" or "svn+ssh://developername@svn.berlios.de/svnroot/repos/donrails/trunk"
	* hnf2db.rb: Fix dialogue.

